(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(5),c=a.n(o),l=(a(14),a(8)),i=a(1);function s(){return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"header__logo"}))}var u=r.a.createContext();function m(e){var t=r.a.useContext(u),a=e.card.owner._id===t._id,n=e.card.likes.some((function(e){return e._id===t._id}));return r.a.createElement("div",{className:"elements__item"},r.a.createElement("img",{src:e.card.link,className:"elements__image",alt:e.card.name,onClick:function(){e.onPreviewOpen(e.card)}}),r.a.createElement("div",{className:"elements__trash ".concat(a?"elements__trash_visible":""),onClick:function(){return e.onCardDelete(e.card)}}),r.a.createElement("div",{className:"elements__title-container"},r.a.createElement("h2",{className:"elements__title"},e.card.name),r.a.createElement("div",{className:"elements__like-wrapper"},r.a.createElement("button",{className:"elements__like ".concat(n?"elements__like_active":"elements__like"),type:"button",onClick:function(){return e.onCardLike(e.card)}}),r.a.createElement("p",{className:"elements__like-number"},e.card.likes.length))))}function p(e){var t=r.a.useContext(u);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__wrapper",onClick:e.onEditAvatar},r.a.createElement("div",{className:"profile__avatar profile__reset",style:{backgroundImage:"url(".concat(t.avatar,")")}})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{className:"profile__edit-button profile__reset",type:"button",onClick:e.onEditProfile}),r.a.createElement("p",{className:"profile__label"},t.about)),r.a.createElement("button",{className:"profile__add-button profile__reset",type:"button",onClick:e.onAddPlace})),r.a.createElement("section",{className:"elements"},e.cards.map((function(t){return r.a.createElement(m,{onPreviewOpen:e.onPreviewOpen,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete,card:t,key:t._id})}))))}function d(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))}function _(e){return r.a.createElement("div",{className:"image-preview ".concat(e.card&&"popup__opened")},r.a.createElement("div",{className:"image-preview__container"},r.a.createElement("button",{className:"popup__close-button",type:"button",onClick:e.onClose}),r.a.createElement("img",{src:e.card?e.card.link:"",className:"image-preview__item",alt:e.card?e.card.name:""}),r.a.createElement("h2",{className:"image-preview__title"},e.card?e.card.name:"")))}function f(e){return r.a.createElement("div",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpen&&"popup__opened")},r.a.createElement("form",{className:"popup__container form",name:e.name,onSubmit:e.onSubmit,noValidate:!0},r.a.createElement("button",{className:"popup__close-button",type:"button",onClick:e.onClose}),r.a.createElement("h2",{className:"popup__title"},e.title),e.children,r.a.createElement("button",{className:"popup__save-button form__submit"},e.button)))}function h(e){var t=r.a.useState(""),a=Object(i.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),l=Object(i.a)(c,2),s=l[0],m=l[1],p=r.a.useContext(u);return r.a.useEffect((function(){o(p.name),m(p.about)}),[p]),r.a.createElement(f,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:n,about:s})}},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){o(e.target.value)},className:"popup__profile popup__profile_name form__input",name:"name",minLength:"2",maxLength:"40",placeholder:"\u0418\u043c\u044f",value:n||"",required:!0}),r.a.createElement("span",{className:"form__input-error"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){m(e.target.value)},className:"popup__profile popup__profile_label form__input",minLength:"2",maxLength:"200",name:"about",placeholder:"\u0417\u0430\u043d\u044f\u0442\u0438\u0435",value:s||"",required:!0}),r.a.createElement("span",{className:"form__input-error"})))}function v(e){var t=r.a.useRef();return r.a.createElement(f,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"avatar",button:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}},r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{ref:t,className:"popup__profile popup__profile_label form__input",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",type:"url",required:!0}),r.a.createElement("span",{className:"form__input-error"})))}function E(e){var t=r.a.useState(""),a=Object(i.a)(t,2),n=a[0],o=a[1],c=r.a.useState(""),l=Object(i.a)(c,2),s=l[0],u=l[1];return r.a.createElement(f,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add",button:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddCard({name:n,link:s})}},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){o(e.target.value)},className:"popup__profile popup__profile_name form__input",name:"name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"1",maxLength:"30",required:!0}),r.a.createElement("span",{className:"form__input-error"})),r.a.createElement("div",{className:"form__field"},r.a.createElement("input",{onChange:function(e){u(e.target.value)},className:"popup__profile popup__profile_label form__input",name:"link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",type:"url",required:!0}),r.a.createElement("span",{className:"form__input-error"}))))}var b=a(6),N=a(7),C=new(function(){function e(t){var a=t.url,n=t.headers;Object(b.a)(this,e),this._url=a,this._headers=n}return Object(N.a)(e,[{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{headers:this._headers}).then(this._handleResponse)}},{key:"getUserData",value:function(){return fetch("".concat(this._url,"/users/me"),{headers:this._headers}).then(this._handleResponse)}},{key:"saveUserData",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleResponse)}},{key:"addCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then(this._handleResponse)}},{key:"putLike",value:function(e,t){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:t?"PUT":"DELETE",headers:this._headers}).then(this._handleResponse)}},{key:"avatarChange",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponse)}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"53f63733-0798-40e6-804e-4dfb424b0ce2","Content-Type":"application/json"}});var g=function(){var e=r.a.useState(!1),t=Object(i.a)(e,2),a=t[0],n=t[1],o=r.a.useState(!1),c=Object(i.a)(o,2),m=c[0],b=c[1],N=r.a.useState(!1),g=Object(i.a)(N,2),k=g[0],O=g[1],y=r.a.useState(),w=Object(i.a)(y,2),S=w[0],j=w[1],P=r.a.useState({}),L=Object(i.a)(P,2),D=L[0],A=L[1],U=r.a.useState([]),R=Object(i.a)(U,2),x=R[0],T=R[1];function q(){O(!1),n(!1),b(!1),j(void 0)}return r.a.useEffect((function(){Promise.all([C.getUserData(),C.getInitialCards()]).then((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];A(a),T(n)})).catch((function(e){console.log(e)}))}),[]),r.a.createElement("div",{className:"App"},r.a.createElement(u.Provider,{value:D},r.a.createElement("div",{className:"page"},r.a.createElement(s,null),r.a.createElement(p,{onEditProfile:function(){n(!0)},onAddPlace:function(){b(!0)},onEditAvatar:function(){O(!0)},onPreviewOpen:function(e){j(e)},cards:x,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===D._id}));C.putLike(e._id,!t).then((function(t){var a=x.map((function(a){return a._id===e._id?t:a}));T(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){C.deleteCard(e._id).then((function(){var t=x.filter((function(t){return t._id!==e._id}));T(t)})).catch((function(e){console.log(e)}))}}),r.a.createElement(h,{isOpen:a,onClose:q,onUpdateUser:function(e){C.saveUserData(e).then((function(e){A(e),q()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(E,{isOpen:m,onClose:q,onAddCard:function(e){C.addCard(e).then((function(e){T([e].concat(Object(l.a)(x))),q()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(v,{isOpen:k,onClose:q,onUpdateAvatar:function(e){C.avatarChange(e).then((function(e){A(e),q()})).catch((function(e){return console.log(e)}))}}),r.a.createElement(f,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"delete",button:"\u0414\u0430"}),r.a.createElement(_,{card:S,onClose:q}),r.a.createElement(d,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){e.exports=a(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.f847ba52.chunk.js.map